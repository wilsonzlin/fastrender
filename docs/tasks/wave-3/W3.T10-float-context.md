---
task_id: "W3.T10"
title: "Implement Float Context"
wave: 3
estimated_hours: 8-12
depends_on:
  - "W2.T07"
  - "W1.R01"
inputs:
  - "outputs/notes/W2.T07-notes.md"
  - "outputs/notes/W1.R01-notes.md"
outputs:
  - "src/layout/contexts/float.rs"
  - "src/layout/float_context.rs"
  - "tests/layout/test_float.rs"
  - "outputs/notes/W3.T10-notes.md"
skills_required:
  - "Rust"
  - "CSS float layout"
  - "Geometric algorithms"
context_files:
  - "docs/plan/02-float-layout.md"
verification:
  - "cargo test layout::float"
---

# Implement Float Context

## Context

Floats are boxes that move to the left or right side of their container, with content flowing around them. Float context tracks float positions to enable text wrapping.

### Background

**Float Context:**
- Maintains list of active floats
- Provides available rect for content (excluding float areas)
- Handles left floats, right floats
- Clears floats (clear property)

**Key data structure:**
```rust
pub struct FloatContext {
    left_floats: Vec<FloatBox>,
    right_floats: Vec<FloatBox>,
}

struct FloatBox {
    rect: Rect,
    clearance: ClearType,
}
```

## Implementation

```rust
impl FloatContext {
    /// Adds a float to the context
    pub fn add_float(&mut self, rect: Rect, float_type: Float);

    /// Gets available rect at given y position
    pub fn get_available_rect(&self, y: f32, height: f32) -> Rect;

    /// Computes clearance needed for clear property
    pub fn compute_clearance(&self, clear: Clear) -> f32;
}
```

## Testing

Tests (20+):
- Single left float
- Single right float
- Multiple floats
- Text wrapping around floats
- Clear: left/right/both
- Float stacking

Time: 8-12 hours
