---
task_id: "W3.T07"
title: "Implement Table Column Width Distribution Algorithm"
wave: 3
estimated_hours: 8-10
depends_on:
  - "W3.T06"
inputs:
  - "outputs/notes/W3.T06-notes.md"
  - "src/layout/contexts/table/width.rs"
outputs:
  - "src/layout/contexts/table/column_distribution.rs"
  - "tests/layout/test_table_columns.rs"
  - "outputs/notes/W3.T07-notes.md"
skills_required:
  - "Rust"
  - "CSS table width algorithms"
  - "Constraint solving"
context_files:
  - "docs/plan/02-table-layout.md"
verification:
  - "cargo test layout::table_columns"
---

# Implement Table Column Width Distribution Algorithm

## Context

Table column width distribution is a complex constraint-solving problem where we need to distribute available table width across columns while respecting min/max constraints, percentage widths, and fixed widths.

This **Wave 3 task** refines W3.T06 table layout with sophisticated column width distribution.

### Background

**Column Width Distribution:**

CSS 2.1 Section 17.5.2.2 defines the auto table layout algorithm:

**Key constraints:**
- **Min width**: Column must be at least as wide as widest minimum content
- **Max width**: Column prefers to be as wide as widest maximum content
- **Fixed width**: Explicit width from <col> or cells takes precedence
- **Percentage width**: Relative to table width
- **Proportional distribution**: Extra space distributed proportionally

**Algorithm steps:**
1. Compute min/max widths for each column (from all cells)
2. Handle colspan cells (distribute across spanned columns)
3. Apply fixed and percentage widths
4. Distribute remaining space proportionally
5. Handle over-constrained tables (width < sum of minimums)

### Why This Matters

Column distribution affects:
- **W3.T06**: Table layout quality
- **Cell rendering**: Correct cell widths
- **Text wrapping**: Content fits properly

Without proper distribution:
- Tables look bad
- Content overflows
- WPT failures

## Implementation Guide

### Key Algorithm

```rust
pub struct ColumnConstraints {
    pub min_width: f32,
    pub max_width: f32,
    pub fixed_width: Option<f32>,
    pub percentage: Option<f32>,
}

pub fn distribute_table_width(
    columns: &[ColumnConstraints],
    table_width: f32,
) -> Vec<f32> {
    // 1. Apply fixed widths
    // 2. Resolve percentages
    // 3. Compute remaining space
    // 4. Distribute proportionally
}
```

## Testing Requirements

**Required tests** (20+ tests):
1. Equal distribution
2. Fixed widths
3. Percentage widths
4. Mixed constraints
5. Over-constrained tables
6. Colspan cells

## Time Tracking

Total: 8-10 hours
