---
task_id: "W4.T01"
title: "Implement Bidi Analyzer (Unicode Bidirectional Algorithm)"
wave: 4
estimated_hours: 8-10
depends_on:
  - "W1.R03"
inputs:
  - "docs/tasks/notes/W1.R03-notes.md"
outputs:
  - "src/text/bidi.rs"
  - "tests/text/test_bidi.rs"
  - "docs/tasks/notes/W4.T01-notes.md"
skills_required:
  - "Rust"
  - "Unicode bidirectional algorithm (UAX#9)"
context_files:
  - "docs/text/shaping.md"
verification:
  - "cargo test text::bidi"
---

# Implement Bidi Analyzer

## Context

Bidirectional text (Arabic, Hebrew) requires analyzing text direction using Unicode Bidirectional Algorithm (UAX#9). Use `unicode-bidi` crate.

## Implementation

```rust
use unicode_bidi::{BidiInfo, BidiClass};

pub fn analyze_bidi(text: &str) -> Vec<BidiRun> {
    let bidi_info = BidiInfo::new(text, None);
    // Extract visual runs with direction
}

pub struct BidiRun {
    pub start: usize,
    pub end: usize,
    pub level: u8,
    pub direction: Direction,
}
```

## Testing

Tests (15+):
- LTR text only
- RTL text only
- Mixed LTR/RTL
- Nested embedding
- UAX#9 test cases

Time: 8-10 hours
